%% OpenQuant Architecture - Pure Quantitative Trading Robot
%% Updated: 2025-11-27
%% Philosophy: Mathematical models, statistics, probability - NO retail indicators

flowchart TD
    subgraph DataLayer["Data Layer"]
        YF[yfinance<br/>Equities]
        CCXT[ccxt<br/>Crypto]
        MT5D[MT5<br/>Forex/CFD]
    end

    subgraph QuantCore["Quantitative Core"]
        STAT[Stationarity<br/>ADF, KPSS]
        KALMAN[Kalman Filter<br/>Dynamic Beta]
        COINT[Cointegration<br/>Engle-Granger]
        GARCH[GARCH 1,1<br/>Volatility]
        HURST[Hurst Exponent<br/>Mean Reversion]
        MICRO[Microstructure<br/>VPIN, Order Flow]
    end

    subgraph Strategies["Strategy Layer"]
        STATARB[Stat-Arb<br/>Pairs Trading]
        KALSTRAT[Kalman Strategy<br/>Spread Trading]
        HURSTSTRAT[Hurst Strategy<br/>Mean Reversion]
        MLSTRAT[ML Strategy<br/>SKLearn]
        MIXER[Strategy Mixer<br/>Ensemble]
    end

    subgraph Evaluation["Evaluation & Optimization"]
        BT[Backtest Engine<br/>Vectorized]
        WFO[Walk-Forward<br/>Optimization]
        DSR[Deflated Sharpe<br/>Overfitting Check]
        OPTUNA[Optuna<br/>Bayesian Search]
        GENETIC[Genetic<br/>Optimization]
    end

    subgraph Risk["Risk Management"]
        GUARD[Guardrails<br/>MaxDD, CVaR]
        EXPOSURE[Exposure<br/>Correlation Check]
        CONC[Concentration<br/>Limits]
        TCA[TCA<br/>Slippage Analysis]
    end

    subgraph Execution["Execution Layer"]
        PAPER[Paper Trading<br/>Simulator]
        ALPACA[Alpaca<br/>Broker]
        MT5E[MT5 Bridge<br/>Live Trading]
    end

    subgraph Storage["Persistence"]
        DUCKDB[(DuckDB<br/>Results DB)]
        CACHE[(Parquet<br/>Data Cache)]
    end

    %% Data Flow
    YF --> QuantCore
    CCXT --> QuantCore
    MT5D --> QuantCore

    QuantCore --> Strategies
    Strategies --> BT
    BT --> WFO
    WFO --> DSR
    DSR --> OPTUNA
    OPTUNA --> GENETIC

    Evaluation --> Risk
    Risk --> Execution

    BT --> DUCKDB
    QuantCore --> CACHE


flowchart TD
    U[Start Universe Run] --> D[Discover Symbols]
    D --> L[Load/Fetch OHLCV (cache+rate-limit)]
    L --> V[Validate Data]
    V --> G[Build Base Param Grid]
    G --> S{Seed From DB best_configs?}
    S -- yes --> B[Get (params, score)]
    B --> N[Narrow Grid Â±band(score)]
    S -- no --> N
    N --> O[Optuna over narrowed grid (n_trials(score))]
    O --> E[Evaluate Best Params]
    E --> W{Run WFO?}
    W -- yes --> WFO[Walk-Forward Evaluate over narrowed grid]
    W -- no --> P
    WFO --> P[Persist Rows to DuckDB]
    E --> P
    P --> R[Refresh best_configs]
    R --> M[Write Report + Auto-open Dashboard]

